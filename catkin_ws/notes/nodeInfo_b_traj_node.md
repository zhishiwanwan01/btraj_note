# BTraj ä¸»è½¨è¿¹è§„åˆ’å™¨èŠ‚ç‚¹ä¿¡æ¯ (b_traj_node)

## èŠ‚ç‚¹åŠŸèƒ½æ¦‚è¿°
**æ ¸å¿ƒèŒè´£**ï¼šæ— äººæœºè½¨è¿¹è§„åˆ’çš„ä¸»èŠ‚ç‚¹ï¼Œæ•´åˆå‰ç«¯è·¯å¾„æœç´¢ä¸åç«¯è´å¡å°”æ›²çº¿ä¼˜åŒ–

---

## å‘å¸ƒçš„è¯é¢˜ (Publications)

### ğŸ¯ æ ¸å¿ƒè¾“å‡º
 * `/b_traj_node/trajectory` [quadrotor_msgs/PolynomialTrajectory]
   - **åŠŸèƒ½**ï¼šå‘å¸ƒä¼˜åŒ–åçš„è´å¡å°”æ›²çº¿è½¨è¿¹ï¼ˆ8é˜¶å¤šé¡¹å¼ç³»æ•°ï¼‰
   - **ç›®æ ‡**ï¼šâ†’ b_traj_serverï¼ˆè½¨è¿¹æ‰§è¡ŒæœåŠ¡å™¨ï¼‰
   - **æ•°æ®**ï¼šå¤šæ®µè½¨è¿¹çš„ç³»æ•°æ•°ç»„ã€æ—¶é—´ä¿¡æ¯ã€é˜¶æ•°ä¿¡æ¯

### ğŸ“Š å¯è§†åŒ–è¾“å‡ºï¼ˆå‘é€ç»™RVizï¼‰
 * `/b_traj_node/trajectory_vis` [visualization_msgs/Marker]
   - **åŠŸèƒ½**ï¼šè½¨è¿¹å¯è§†åŒ–çº¿æ¡ï¼Œåœ¨RVizä¸­æ˜¾ç¤ºè§„åˆ’çš„è·¯å¾„

 * `/b_traj_node/corridor_vis` [visualization_msgs/MarkerArray]
   - **åŠŸèƒ½**ï¼šé£è¡Œèµ°å»Šå¯è§†åŒ–ï¼Œæ˜¾ç¤ºå®‰å…¨é£è¡ŒåŒºåŸŸè¾¹ç•Œ

 * `/b_traj_node/path_vis` [visualization_msgs/MarkerArray]
   - **åŠŸèƒ½**ï¼šå‰ç«¯è·¯å¾„æœç´¢ç»“æœå¯è§†åŒ–ï¼ˆA*æˆ–Fast Marching*è¾“å‡ºï¼‰

 * `/b_traj_node/grid_path_vis` [visualization_msgs/MarkerArray]
   - **åŠŸèƒ½**ï¼šç½‘æ ¼è·¯å¾„å¯è§†åŒ–ï¼Œæ˜¾ç¤ºç¦»æ•£åŒ–çš„è·¯å¾„èŠ‚ç‚¹

 * `/b_traj_node/expanded_nodes_vis` [visualization_msgs/Marker]
   - **åŠŸèƒ½**ï¼šè·¯å¾„æœç´¢è¿‡ç¨‹ä¸­æ‰©å±•çš„èŠ‚ç‚¹å¯è§†åŒ–ï¼ˆè°ƒè¯•ç”¨ï¼‰

 * `/b_traj_node/check_trajectory` [visualization_msgs/Marker]
   - **åŠŸèƒ½**ï¼šè½¨è¿¹æ£€æŸ¥ç»“æœå¯è§†åŒ–ï¼Œæ˜¾ç¤ºç¢°æ’æ£€æµ‹ä¿¡æ¯

 * `/b_traj_node/stop_trajectory` [visualization_msgs/Marker]
   - **åŠŸèƒ½**ï¼šç´§æ€¥åœæ­¢è½¨è¿¹å¯è§†åŒ–

### ğŸ—ºï¸ åœ°å›¾å¤„ç†è¾“å‡º
 * `/b_traj_node/vis_map_inflate` [sensor_msgs/PointCloud2]
   - **åŠŸèƒ½**ï¼šè†¨èƒ€åçš„éšœç¢ç‰©åœ°å›¾ï¼Œæ˜¾ç¤ºå®‰å…¨è¾¹è·åçš„éšœç¢ç‰©

 * `/b_traj_node/vis_map_local` [sensor_msgs/PointCloud2]
   - **åŠŸèƒ½**ï¼šå±€éƒ¨è§„åˆ’çª—å£å†…çš„åœ°å›¾æ•°æ®

### ğŸ”§ ç³»ç»Ÿè¯é¢˜
 * `/rosout` [rosgraph_msgs/Log] - ROSæ—¥å¿—ç³»ç»Ÿ
 * `/tf` [tf2_msgs/TFMessage] - åæ ‡å˜æ¢ä¿¡æ¯

---

## è®¢é˜…çš„è¯é¢˜ (Subscriptions)

### ğŸ“ è¾“å…¥æ•°æ®æº
 * `/odom/fake_odom` [nav_msgs/Odometry]
   - **æ¥æº**ï¼šodom_generatorï¼ˆé‡Œç¨‹è®¡ç”Ÿæˆå™¨ï¼‰
   - **åŠŸèƒ½**ï¼šæ¥æ”¶æ— äººæœºå½“å‰ä½ç½®ã€é€Ÿåº¦ã€å§¿æ€ä¿¡æ¯
   - **ç”¨é€”**ï¼šä½œä¸ºè½¨è¿¹è§„åˆ’çš„èµ·å§‹çŠ¶æ€

 * `/random_forest_sensing/random_forest` [sensor_msgs/PointCloud2]
   - **æ¥æº**ï¼šrandom_forest_sensingï¼ˆç¯å¢ƒæ„ŸçŸ¥èŠ‚ç‚¹ï¼‰
   - **åŠŸèƒ½**ï¼šæ¥æ”¶å±€éƒ¨éšœç¢ç‰©ç‚¹äº‘åœ°å›¾
   - **ç”¨é€”**ï¼šå‰ç«¯è·¯å¾„æœç´¢å’Œåç«¯è½¨è¿¹ä¼˜åŒ–çš„éšœç¢ç‰©çº¦æŸ

 * `/waypoint_generator/waypoints` [nav_msgs/Path]
   - **æ¥æº**ï¼šwaypoint_generatorï¼ˆèˆªç‚¹ç”Ÿæˆå™¨ï¼‰
   - **åŠŸèƒ½**ï¼šæ¥æ”¶ç”¨æˆ·åœ¨RVizä¸­è®¾ç½®çš„ç›®æ ‡èˆªç‚¹
   - **ç”¨é€”**ï¼šè½¨è¿¹è§„åˆ’çš„ç»ˆç‚¹ç›®æ ‡

---

## æä¾›çš„æœåŠ¡ (Services)

### ğŸ”§ æ ‡å‡†ROSæœåŠ¡
 * `/b_traj_node/get_loggers` - è·å–èŠ‚ç‚¹æ—¥å¿—çº§åˆ«é…ç½®
 * `/b_traj_node/set_logger_level` - åŠ¨æ€è®¾ç½®èŠ‚ç‚¹æ—¥å¿—çº§åˆ«

---

## è¿è¡Œæ—¶è¿æ¥ä¿¡æ¯ (Runtime Connections)

### ğŸ“¡ èŠ‚ç‚¹è¿è¡ŒçŠ¶æ€
- **å®¹å™¨åœ°å€**ï¼šbtrajSim-Melodic:36577
- **è¿›ç¨‹ID**ï¼š202
- **ä¼ è¾“åè®®**ï¼šTCPROSï¼ˆTCPå¯é ä¼ è¾“ï¼‰

### ğŸ”„ æ•°æ®æµè¿æ¥åˆ†æ

#### è¾“å‡ºè¿æ¥ (Outbound) - èŠ‚ç‚¹å‘å¤–å‘é€æ•°æ®
```
ğŸ¯ æ ¸å¿ƒè½¨è¿¹è¾“å‡º
â””â”€â”€ /b_traj_node/trajectory â†’ /b_traj_server [æ ¸å¿ƒä¸šåŠ¡æ•°æ®]

ğŸ“Š å¯è§†åŒ–è¾“å‡ºï¼ˆå…¨éƒ¨å‘é€ç»™RVizï¼‰
â”œâ”€â”€ /b_traj_node/trajectory_vis â†’ /rvizvisualisation [è½¨è¿¹çº¿æ¡]
â”œâ”€â”€ /b_traj_node/corridor_vis â†’ /rvizvisualisation [é£è¡Œèµ°å»Š]
â”œâ”€â”€ /b_traj_node/path_vis â†’ /rvizvisualisation [å‰ç«¯è·¯å¾„]
â”œâ”€â”€ /b_traj_node/grid_path_vis â†’ /rvizvisualisation [ç½‘æ ¼è·¯å¾„]
â”œâ”€â”€ /b_traj_node/expanded_nodes_vis â†’ /rvizvisualisation [æœç´¢èŠ‚ç‚¹]
â”œâ”€â”€ /b_traj_node/check_trajectory â†’ /rvizvisualisation [è½¨è¿¹æ£€æŸ¥]
â”œâ”€â”€ /b_traj_node/stop_trajectory â†’ /rvizvisualisation [åœæ­¢è½¨è¿¹]
â””â”€â”€ /b_traj_node/vis_map_local â†’ /rvizvisualisation [å±€éƒ¨åœ°å›¾]

ğŸ”§ ç³»ç»Ÿè¾“å‡º
â”œâ”€â”€ /rosout â†’ /rosout [æ—¥å¿—ç³»ç»Ÿ]
â””â”€â”€ /tf â†’ /rvizvisualisation [åæ ‡å˜æ¢]
```

#### è¾“å…¥è¿æ¥ (Inbound) - èŠ‚ç‚¹æ¥æ”¶å¤–éƒ¨æ•°æ®
```
ğŸ“ æ ¸å¿ƒè¾“å…¥æ•°æ®æµ
â”œâ”€â”€ /waypoint_generator/waypoints â† waypoint_generator [ç›®æ ‡èˆªç‚¹]
â”œâ”€â”€ /odom/fake_odom â† odom_generator [å½“å‰çŠ¶æ€]
â””â”€â”€ /random_forest_sensing/random_forest â† random_forest_sensing [éšœç¢ç‰©åœ°å›¾]
```

### ğŸ’¡ è¿æ¥æ¨¡å¼åˆ†æ
- **ä¸»è¦è¾“å‡ºç›®æ ‡**ï¼šRVizï¼ˆ8ä¸ªå¯è§†åŒ–è¯é¢˜ï¼‰+ b_traj_serverï¼ˆ1ä¸ªæ ¸å¿ƒä¸šåŠ¡è¯é¢˜ï¼‰
- **ä¸»è¦è¾“å…¥æ¥æº**ï¼š3ä¸ªæ ¸å¿ƒæ•°æ®æºï¼ˆèˆªç‚¹ã€çŠ¶æ€ã€åœ°å›¾ï¼‰
- **æ•°æ®æµç‰¹ç‚¹**ï¼šå¤šè¾“å‡ºï¼ˆè°ƒè¯•å¯è§†åŒ–ä¸°å¯Œï¼‰ã€å°‘è¾“å…¥ï¼ˆæ•°æ®æºç®€æ´ï¼‰
- **ç³»ç»Ÿè§’è‰²**ï¼šæ•°æ®å¤„ç†ä¸­å¿ƒï¼Œæ¥æ”¶å°‘é‡å…³é”®è¾“å…¥ï¼Œäº§ç”Ÿå¤§é‡è°ƒè¯•è¾“å‡º

---

## ğŸ” èŠ‚ç‚¹åˆ†ææ€»ç»“

### æ ¸å¿ƒåŠŸèƒ½
1. **è½¨è¿¹è§„åˆ’**ï¼šæ•´åˆè·¯å¾„æœç´¢å’Œè´å¡å°”ä¼˜åŒ–ç®—æ³•
2. **æ•°æ®èåˆ**ï¼šèåˆä½ç½®ã€åœ°å›¾ã€ç›®æ ‡ä¸‰ç±»è¾“å…¥
3. **å¯è§†åŒ–è¾“å‡º**ï¼šæä¾›ä¸°å¯Œçš„è°ƒè¯•å’Œç›‘æ§ä¿¡æ¯

### è®¾è®¡ç‰¹ç‚¹
- **è¾“å…¥ç®€æ´**ï¼šåªå…³æ³¨å¿…è¦çš„3ç±»æ•°æ®
- **è¾“å‡ºä¸°å¯Œ**ï¼šæä¾›9ç§å¯è§†åŒ–ç”¨äºè°ƒè¯•åˆ†æ
- **èŒè´£æ¸…æ™°**ï¼šä¸“æ³¨è§„åˆ’ç®—æ³•ï¼Œä¸æ¶‰åŠæ‰§è¡Œæ§åˆ¶

### åœ¨ç³»ç»Ÿä¸­çš„ä½ç½®
- **ä¸Šæ¸¸**ï¼šwaypoint_generator, odom_generator, random_forest_sensing
- **ä¸‹æ¸¸**ï¼šb_traj_serverï¼ˆæ ¸å¿ƒï¼‰, rvizvisualisationï¼ˆè°ƒè¯•ï¼‰
- **è§’è‰²**ï¼šç³»ç»Ÿçš„"å¤§è„‘"ï¼Œè´Ÿè´£æ™ºèƒ½å†³ç­–å’Œè½¨è¿¹ç”Ÿæˆ

